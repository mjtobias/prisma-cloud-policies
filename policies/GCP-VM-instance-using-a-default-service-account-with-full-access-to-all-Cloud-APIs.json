{
  "policyUpi": "PC-GCP-GCE-534",
  "policyId": "7e4e6196-4922-4efd-acb9-7a4afc1c379a",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP VM instance using a default service account with full access to all Cloud APIs",
  "description": "This policy identifies the GCP VM instances which are using a default service account with full access to all Cloud APIs. To compliant with the principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account 'Compute Engine default service account' with scope 'Allow full access to all Cloud APIs'.",
  "rule.criteria": "b47d9e56-f289-46c4-a8e2-3c0b564f2c6a",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = serviceAccounts[*].email contains \"-compute@developer.gserviceaccount.com\" and serviceAccounts[*].scopes[*] any equal \"https://www.googleapis.com/auth/cloud-platform\"",
  "recommendation": "1. Log in to GCP portal \n2. Go to Compute Engine\n3. Choose VM instances\n4. Click on the reported VM instance for which you want to change the service account\n5. If the instance is not stopped, click the 'Stop' button. Wait for the instance to be stopped\n6. Next, click the 'Edit' button\n7. Scroll down to the 'Service Account' section, From the drop-down menu, select the desired service account or ensure that 'Allow full access to all Cloud APIs' is not selected.\n8. Click the 'Save' button and then click 'START' to start VM instance.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS v1.0.0 (GCP)"
  ]
}