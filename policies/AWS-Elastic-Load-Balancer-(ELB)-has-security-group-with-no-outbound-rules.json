{
  "policyUpi": "PC-AWS-ELB-311",
  "policyId": "bc6fafc0-c5f8-4ddd-b07d-0e4394c06ad0",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS Elastic Load Balancer (ELB) has security group with no outbound rules",
  "description": "This policy identifies Elastic Load Balancers (ELB) which have security group with no outbound rules. A security group with no outbound rule will deny all outgoing requests. ELB security groups should have at least one outbound rule, ELB with no outbound permissions will deny all traffic going to any EC2 instances or resources configured behind that ELB; in other words, the ELB is useless without outbound permissions.",
  "rule.criteria": "886dc8ea-3c1b-4a7c-819c-610870e7042d",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-elb-describe-load-balancers' as X; config from cloud.resource where api.name = 'aws-ec2-describe-security-groups' as Y; filter '$.X.description.securityGroups[*] contains $.Y.groupId and $.Y.ipPermissionsEgress[*] is empty'; show X;",
  "recommendation": "1. Log in to the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to EC2 Dashboard\n4. Click on 'Load Balancers', choose the reported load balancer\n5. Click on the 'Description' tab, click on the security group, it will open Security Group properties in a new tab in your browser\n6. Click on the 'Outbound Rules'\n7. If there are no rules, click on 'Edit rules', add an outbound rule according to your ELB functional requirement\n8. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}