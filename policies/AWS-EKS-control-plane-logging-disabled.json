{
  "policyUpi": "PC-AWS-EKS-381",
  "policyId": "3fe88e1f-79f9-42a0-9fee-e5ae348b7cb0",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS EKS control plane logging disabled",
  "description": "Amazon EKS control plane logging provides audit and diagnostic logs directly from the Amazon EKS control plane to CloudWatch Logs in your account. These logs make it easy for you to secure and run your clusters. You can select the exact log types you need, and logs are sent as log streams to a group for each Amazon EKS cluster in CloudWatch.\n\nThis policy generates an alert if control plane logging is disabled.",
  "rule.criteria": "ddc8ccc2-2510-4779-b4ba-756a41214f18",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-eks-describe-cluster' AND json.rule =  logging.clusterLogging[*].types[*] all empty or logging.clusterLogging[*].enabled is false",
  "recommendation": "To enable control plane logs:\n\n1. Login to AWS Console\n2. Navigate to the Amazon EKS dashboard\n3. Choose the name of the cluster to display your cluster information\n4. Under Logging, choose 'Manage logging'\n5. For each individual log type, choose Enabled\n6. Click on 'Save changes'",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws eks update-cluster-config --name ${resourceName} --region ${region} --logging '{\"clusterLogging\":[{\"types\":[\"api\",\"audit\",\"authenticator\",\"controllerManager\",\"scheduler\"],\"enabled\":true}]}'",
  "remediation.description": "This CLI command requires 'eks:UpdateClusterConfig' permission. Successful execution will enable control plane logging for the respective EKS.",
  "remediation.impact": "Enable control plane logging for the respective EKS",
  "compliance.standard": [
    "CCPA 2018",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "PIPEDA"
  ]
}