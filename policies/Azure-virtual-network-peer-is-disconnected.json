{
  "policyUpi": "PC-AZR-NWK-301",
  "policyId": "3fc7b5fc-9394-4cb7-9baf-aaccfd38e9d1",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure virtual network peer is disconnected",
  "description": "Virtual network peering enables you to connect two Azure virtual networks so that the resources in these networks are directly connected.\n\nThis policy identifies Azure virtual network peers that are disconnected. Typically, the disconnection happens when a peering configuration is deleted on one virtual network, and the other virtual network reports the peering status as disconnected.",
  "rule.criteria": "177fdb75-0481-4349-bcd2-e172779fb63b",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-network-vnet-list'  AND json.rule = ['properties.virtualNetworkPeerings'][*].['properties.peeringState'] equals \"Disconnected\"",
  "recommendation": "To reconnect the virtual network peers, you need to delete the 'Disconnected' peering connection and re-configure the peering connection.\n\nTo re-configure the peering connection:\n1. Log in to the Azure Portal.\n2. Select 'Virtual Networks', and select the virtual network on which has 'Disconnected' peering.\n3. Select 'Peerings'.\n4. Delete the peering with 'Disconnected' status.\n5. Select 'Add' to re-initiate the peering configuration.\n6. Specify the 'Name' and target 'Virtual Network'.\n7. Select 'OK'\n8. Verify that peering state is 'Initiated'.\n9. Repeat step 5-7 on the target/other vnet.\n10. Verify that the peering state is 'Connected'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": ""
}