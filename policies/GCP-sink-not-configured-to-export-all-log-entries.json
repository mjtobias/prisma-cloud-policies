{
  "policyUpi": "PC-GCP-LOG-496",
  "policyId": "e4020877-5454-4152-803f-d7d23fc28115",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP sink not configured to export all log entries",
  "description": "This policy identifies GCP logging sinks which are not configured to export all the log entries. To ensure all log entries are exported using sink ensure that there is no filter configured for a sink.",
  "rule.criteria": "fed6f5f4-ec9c-4b1f-aef7-f258bb075ba8",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-logging-sinks-list' AND json.rule = 'filter does not exist and destination.bucket exists' as X; count(X) less than 1",
  "recommendation": "1. Login to gcloud console.\n2. Navigate to 'Logging' section under 'STACKDRIVER' category.\n3. Click on Logs Router\n4. For every sink, click 3 dot button for Menu option and select 'View Filter'\n5. Ensure that there is at least one sink with 'empty' Sink Filter\n6. Additionally for Sink with 'empty' sink filter, Ensure resource mentioned in 'Destination' Exists.\n7. In case there is not sink with empty filter, follow below step to have a compliant sink\n8. For a sink click 3 dot button for Menu option and select 'Edit Filter'\n9. Clear any text from the filter bar\n10. Configure 'Sink Name'. In 'sink service' click drop down 'select destination' and select desired service to store exports, preferably 'Cloud Storage'\n11. In 'Select Destination' click drop down and select desired destination resource or If required create new.\n12. Click 'Create Sink'.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GCP)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}