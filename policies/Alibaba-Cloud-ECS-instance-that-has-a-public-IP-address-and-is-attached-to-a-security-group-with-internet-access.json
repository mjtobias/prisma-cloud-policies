{
  "policyUpi": "PC-ALB-ECS-456",
  "policyId": "fe461b51-4ba7-465e-a752-6eab2e493cbb",
  "policyType": "config",
  "cloudType": "alibaba_cloud",
  "severity": "medium",
  "name": "Alibaba Cloud ECS instance that has a public IP address and is attached to a security group with internet access",
  "description": "This policy identifies ECS instances that have a public IP address and are attached to security groups with internet access. Because an ECS instance receives a public IP address at the launch, by default, as a best practice ensure that the instance is attached to a security group which is not overly permissive.",
  "rule.criteria": "9b47b40f-b4fe-4a6a-a2fe-2ee8931ca58a",
  "searchModel.query": "config from cloud.resource where api.name = 'alibaba-cloud-ecs-instance' as X; config from cloud.resource where api.name = 'alibaba-cloud-ecs-security-group' as Y; filter \"$.X.publicIpAddress[*] is not empty and $.X.securityGroupIds[*] contains $.Y.securityGroupId and $.Y.permissions[?(@.policy=='Accept' && @.direction=='ingress')].sourceCidrIp contains 0.0.0.0/0\"; show X;",
  "recommendation": "Instead of using a public IP address for the ECS instance, either associate an Elastic IP address to it or evaluate the rules for the security groups to ensure restricted access.\n\nTo allocate an Elastic IP address, follow the instructions below:\n1. Log in to Alibaba Cloud Portal\n2. Go to Elastic Compute Service\n3. Select the reported ECS instance\n4. Choose More > Network and Security Group > Convert to EIP\n5. On 'Convert to EIP' popup window, click on 'OK'\n\nTo restrict Security Groups allowing all traffic, follow the instructions below:\n1. Log in to Alibaba Cloud Portal\n2. Go to Elastic Compute Service\n3. Click on the reported ECS instance\n3. In the left-side navigation pane, choose Security Groups\n4. Check the rules of each security group by clicking on 'Add Rules' in the Actions column\n5. In Inbound tab, Select the rule having 'Action' as Allow and 'Authorization Object' as 0.0.0.0/0, Click Modify in the Actions column\n6. Replace the value 0.0.0.0/0 with specific IP address range.\n7. Click on 'OK'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}