{
  "policyUpi": "PC-AZR-STO-298",
  "policyId": "fde9482f-3ac2-43f6-bda2-bf2013074acd",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure storage account logging for queues is disabled",
  "description": "Storage Logging records details of requests (read, write, and delete operations) against your Azure queues. The logs include additional information such as:\n- Timing and server latency.\n- Success or failure, and HTTP status code.\n- Authentication details\n\nThis policy identifies Azure storage accounts that do not have logging enabled for queues. As a best practice, enable logging for read, write, and delete request types on queues.",
  "rule.criteria": "e6e24f25-8419-467e-96d1-72f14ba24652",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = 'sku.tier equals Standard and (loggingProperties.queue.readEnabled is false or loggingProperties.queue.writeEnabled is false or loggingProperties.queue.deleteEnabled is false)'",
  "recommendation": "1. Log in to the Azure portal.\n2. Select 'Storage Accounts'.\n3. Select the storage account you need to modify.\n4. Select 'Diagnostic Logs (classic)'.\n5. Set the 'status' to 'On'.\n6. Select 'Queue properties' tab.\n7. Enable 'Logging' for the three operations - 'Read', 'Write', 'Delete'.\n8. (Optionally) Select 'Delete data', and specify the number of days for which to retain data.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CCPA 2018",
    "CIS v1.1 (Azure)",
    "MITRE ATT&CK [Beta]",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "PIPEDA"
  ]
}