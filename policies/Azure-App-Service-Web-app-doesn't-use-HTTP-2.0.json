{
  "policyUpi": "PC-AZR-APP-410",
  "policyId": "4f5c4a28-c3df-4bee-a980-621c794548ed",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure App Service Web app doesn't use HTTP 2.0",
  "description": "HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
  "rule.criteria": "54957a87-ae1f-4776-a656-7a274498b153",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'config.http20Enabled equals false'",
  "recommendation": "1. Log in to the Azure portal\n2. Navigate to App Services\n3. Click on the reported App\n4. Under Setting section, Click on 'Configuration'\n5. Under 'General Settings' tab, In 'Platform settings', Set 'HTTP version' to '2.0'",
  "remediable": true,
  "remediation.cliScriptTemplate": "az webapp config set --resource-group ${resourceGroup} --name ${resourceName} --http20-enabled true",
  "remediation.description": "This CLI command requires 'Microsoft.Web/sites/{app_name}/config/*' permission. Successful execution sets HTTP version to 2.0, which has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests.",
  "remediation.impact": "Sets latest HTTP version in Azure App Service",
  "compliance.standard": [
    "CIS v1.1 (Azure)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}