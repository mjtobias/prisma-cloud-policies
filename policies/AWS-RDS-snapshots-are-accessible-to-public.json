{
  "policyUpi": "PC-AWS-RDS-32",
  "policyId": "a707de6a-11b7-478a-b636-5e21ee1f6162",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "high",
  "name": "AWS RDS snapshots are accessible to public",
  "description": "This policy identifies AWS RDS snapshots which are accessible to public. Amazon Relational Database Service (Amazon RDS) is a web service that makes it easier to setup and manage databases. If RDS snapshots are inadvertently shared to public, any unauthorized user with AWS console access can gain access to the snapshots and gain access to sensitive data.",
  "rule.criteria": "a707de6a-11b7-478a-b636-5e21ee1f6162",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' and api.name='aws-rds-describe-db-snapshots' AND json.rule=\"attributes[?(@.attributeName=='restore')]‌‌.attributeValues[*] contains all\"",
  "recommendation": "1. Sign in to the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to the 'RDS' service.\n4. For the RDS instance reported in the alert, change 'Publicly Accessible' setting to 'No'.",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws rds --region ${region} modify-db-snapshot-attribute --db-snapshot-identifier ${resourceId} --attribute-name restore --values-to-remove \"all\"",
  "remediation.description": "This CLI command requires 'rds:ModifyDBSnapshotAttribute' permission. Successful execution will reset this RDS snapshot's ACL (Access Control List) to private. This will ensure that only Owner has full privileges.",
  "remediation.impact": "make this RDS snapshot private",
  "compliance.standard": [
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "GDPR",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "MITRE ATT&CK [Beta]",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PCI DSS v3.2",
    "PIPEDA",
    "SOC 2"
  ]
}