{
  "policyUpi": "PC-AWS-KMS-240",
  "policyId": "40edb7ed-948e-4204-a3bb-9597b3e673f2",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS KMS Customer Managed Key not in use",
  "description": "This policy identifies KMS Customer Managed Keys(CMKs) which are not usable. When you create a CMK, it is enabled by default. If you disable a CMK or schedule it for deletion makes it unusable, it cannot be used to encrypt or decrypt data and AWS KMS does not rotate the backing keys until you re-enable it.",
  "rule.criteria": "ded8a84a-8548-4972-9962-caf5aad99d35",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-kms-get-key-rotation-status' AND json.rule = 'keyMetadata.keyManager contains CUSTOMER and (keyMetadata.keyState contains Disabled or keyMetadata.keyState contains PendingDeletion)'",
  "recommendation": "To enable KMS CMKs which are disabled, perform the following:\n1. Sign into the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to Key Management Service (KMS)\n4. Click on 'Customer managed keys' (Left Panel)\n5. Select reported KMS Customer managed key\n6. Click on 'Key actions' dropdown\n7. Click on 'Enable'\n\nYou should delete a CMK only when you are sure that you don't need to use it anymore. If you are not sure, consider disabling the CMK instead of deleting it. To enable KMS CMKs which are scheduled for deletion, perform the following:\n1. Sign into the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to Key Management Service (KMS)\n4. Click on 'Customer managed keys' (Left Panel)\n5. Select reported KMS Customer managed key\n6. Click on 'Key actions' dropdown\n7. Click on 'Cancel key deletion'\n8. Click on 'Enable'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "MITRE ATT&CK [Beta]",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}