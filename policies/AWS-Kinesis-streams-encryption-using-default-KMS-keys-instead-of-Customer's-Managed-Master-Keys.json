{
  "policyUpi": "PC-AWS-KNS-175",
  "policyId": "5c537bb1-64f1-4e56-925e-7f0538800ff0",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS Kinesis streams encryption using default KMS keys instead of Customer's Managed Master Keys",
  "description": "This policy identifies the AWS Kinesis streams which are encrypted with default KMS keys and not with Master Keys managed by Customer. It is a best practice to use customer managed Master Keys to encrypt your Amazon Kinesis streams data. It gives you full control over the encrypted data.",
  "rule.criteria": "5ab3a77d-30f9-46b3-8fd3-2690179abd11",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-kinesis-list-streams' as X; config from cloud.resource where api.name = 'aws-kms-get-key-rotation-status' as Y; filter '$.Y.keyMetadata.keyManager == AWS and $.Y.key.keyArn == $.X.keyId and $.X.encryptionType equals KMS'; show X;",
  "recommendation": "1. Sign in to the AWS Console\n2. Go to Kinesis Service\n3. Select the reported Kinesis data stream for the corresponding region\n4. Under Server-side encryption, Click on Edit\n5. Choose Enabled\n6. Under KMS master key, You can choose any KMS other than the default (Default) aws/kinesis\n7. Click Save",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "GDPR",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PIPEDA",
    "SOC 2"
  ]
}