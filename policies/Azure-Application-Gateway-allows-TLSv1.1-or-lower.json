{
  "policyUpi": "PC-AZR-AGW-326",
  "policyId": "8bf20934-38d6-419e-9e0e-b0c7b0c1d238",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure Application Gateway allows TLSv1.1 or lower",
  "description": "The Application Gateway supports end-to-end SSL encryption using multiple TLS versions and by default, it supports TLS version 1.0 as the minimum version.\n\nThis policy identifies the Application Gateway instances that are configured to use TLS versions 1.1 or lower as the minimum protocol version. As a best practice set the MinProtocolVersion to TLSv1.2 (if you use custom SSL policy) or use the predefined ‘AppGwSslPolicy20170401S’ policy.",
  "rule.criteria": "9aaa2409-fdc4-4a85-af2d-8b2613a57fb4",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-application-gateway' AND json.rule =  \" ['properties.sslPolicy'] does not exist or (['properties.sslPolicy'].policyType == Predefined and ['properties.sslPolicy'].policyName != AppGwSslPolicy20170401S ) or (['properties.sslPolicy'].policyType == Custom and ['properties.sslPolicy'].minProtocolVersion != TLSv1_2)\"",
  "recommendation": "To set the SSL policy using the predefined policy:\n\naz network application-gateway ssl-policy set -g <resource_group_name> --gateway-name <app_gateway_name> -n AppGwSslPolicy20170401S --policy-type Predefined\n\nSee https://docs.microsoft.com/en-us/azure/application-gateway/application-gateway-ssl-policy-overview, for a list of the available predefined policy.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CCPA 2018",
    "MITRE ATT&CK [Beta]",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "PIPEDA"
  ]
}