{
  "policyUpi": "PC-GCP-VPC-402",
  "policyId": "f57d5819-0673-4c25-bf43-77cf66e4800d",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Firewall rules allow inbound traffic from anywhere with no target tags set",
  "description": "This policy identifies GCP Firewall rules which allow inbound traffic from anywhere with no target filtering. \n\nThe default target is all instances in the network. The use of target tags or target service accounts allows the rule to apply to select instances. Not using any firewall rule filtering may allow a bad actor to brute force their way into the system and potentially get access to the entire network.",
  "rule.criteria": "ac2aef26-939c-40e9-9aae-2e9be6fd7d0a",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name='gcloud-compute-firewall-rules-list' AND json.rule =  'direction equals \"INGRESS\" and sourceRanges[*] contains 0.0.0.0/0 and targetTags[*] does not exist and targetServiceAccounts[*] does not exist'",
  "recommendation": "Follow the instructions below to restrict the default target parameter (all instances in the network):\n\n1. Login to GCP Console.\n2. Go to VPC Network.\n3. Go to the Firewall rules.\n4. Click on each Firewall rule reported.\n5. Click Edit.\n6. Change the Targets field from 'All instances in the network' to 'Specified target tags'.\n7. Type the tags into the Target tags field.\n8. Review Source IP ranges and change to specific IP ranges if traffic is not required to be allowed from anywhere.\n9. Click Save.\n\nReference:\nhttps://cloud.google.com/vpc/docs/add-remove-network-tags",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CCPA 2018",
    "MITRE ATT&CK [Beta]",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "PIPEDA"
  ]
}