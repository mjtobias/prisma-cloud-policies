{
  "policyUpi": "PC-AWS-ES-178",
  "policyId": "59c82c7e-2884-4c65-a307-eba3a6fc27d7",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS Elasticsearch domain has Search slow logs set to disabled",
  "description": "This policy identifies Elasticsearch domains for which Search slow logs is disabled in your AWS account. Enabling support for publishing Search slow logs to AWS CloudWatch Logs enables you to have full insight into the performance of search operations performed on your Elasticsearch clusters. This will help you in identifying performance issues caused by specific search queries so that you can optimize your queries to address the problem.",
  "rule.criteria": "e043e14d-6680-451c-8aa7-f0aa61b9cd87",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-es-describe-elasticsearch-domain' AND json.rule = 'logPublishingOptions does not exist or logPublishingOptions.SEARCH_SLOW_LOGS.enabled is false or logPublishingOptions.SEARCH_SLOW_LOGS.cloudWatchLogsLogGroupArn is empty'",
  "recommendation": "1. Sign into the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to Elasticsearch Service Dashboard\n4. Choose reported Elasticsearch domain\n5. Select the 'Logs' tab\n6. In 'Set up Search slow logs' section,\n\ta. click on 'Setup'\n\tb. In 'Select CloudWatch Logs log group' setting, Create/Use existing CloudWatch Logs log group as per your requirement\n\tc. In 'Specify CloudWatch access policy', Create new/Select an existing policy as per your requirement\n\td. Click on 'Enable'\n\nThe search slow logs setting 'Status' should change now to 'Enabled'.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CSA CCM v3.0.1",
    "HITRUST CSF v9.3",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "SOC 2"
  ]
}