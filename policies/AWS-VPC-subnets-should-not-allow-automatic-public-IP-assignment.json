{
  "policyUpi": "PC-AWS-VPC-41",
  "policyId": "11743cd3-35e4-4639-91e1-bc87b52d4cf5",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS VPC subnets should not allow automatic public IP assignment",
  "description": "This policy identifies VPC subnets which allow automatic public IP assignment. VPC subnet is a part of the VPC having its own rules for traffic. Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.",
  "rule.criteria": "11743cd3-35e4-4639-91e1-bc87b52d4cf5",
  "searchModel.query": "config from cloud.resource where cloud.type = 'AWS' and api.name = 'aws-ec2-describe-subnets' AND json.rule = 'mapPublicIpOnLaunch is true'",
  "recommendation": "1. Sign into the AWS console.\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated.\n3. Navigate to the 'VPC' service.\n4. In the navigation pane, click on 'Subnets'.\n5. Select the identified Subnet and choose the option 'Modify auto-assign IP settings' under the Subnet Actions.\n6. Disable the 'Auto-Assign IP' option and save it.",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws ec2 modify-subnet-attribute --subnet-id ${resourceId} --region ${region}  --no-map-public-ip-on-launch",
  "remediation.description": "This CLI command requires 'ec2:ModifySubnetAttribute' permission. Successful execution will disable automatic public IP assignment for the respective Subnet.",
  "remediation.impact": "Disable automatic public IP assignment for the respective Subnet",
  "compliance.standard": [
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "GDPR",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PIPEDA",
    "SOC 2"
  ]
}