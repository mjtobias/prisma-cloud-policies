{
  "policyUpi": "PC-AZR-SQL-135",
  "policyId": "a4acdd5b-e0bf-488d-8e61-23966f7a007e",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Send alerts on field value on SQL Databases is misconfigured",
  "description": "Checks to ensure that an valid email address is set for Threat Detection alerts. The alerts are sent to this email address when any anomalous activities are detected on SQL databases.",
  "rule.criteria": "49f76a03-1381-40d2-a4b2-22d0ea65b4e4",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-db-list' AND json.rule = '$.securityAlertPolicy does not exist or $.securityAlertPolicy.[*] is empty or ($.securityAlertPolicy.properties.state equals Enabled and $.securityAlertPolicy.properties.emailAddresses is empty)'",
  "recommendation": "1. Login to Azure Portal\n2. Go to SQL Databases (Left Panel)\n3. Choose the reported each DB instance\n4. Click on Auditing & Threat Detection (under 'SETTINGS')\n5. Set Auditing to 'ON'\n6. Set Threat Detection to 'ON'\n7. Set 'Send alerts to' field with a valid email address\n8. Click on save",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CSA CCM v3.0.1",
    "HIPAA",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev4",
    "PCI DSS v3.2",
    "SOC 2"
  ]
}