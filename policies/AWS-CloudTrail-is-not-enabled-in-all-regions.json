{
  "policyUpi": "PC-AWS-CT-3",
  "policyId": "36a5345a-230d-438e-a04c-a287a513e3dc",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS CloudTrail is not enabled in all regions",
  "description": "Checks to ensure that CloudTrail is enabled across all regions. AWS CloudTrail is a service that enables governance, compliance, operational & risk auditing of the AWS account. It is a compliance and security best practice to turn on CloudTrail across different regions to get a complete audit trail of activities across various services. ",
  "rule.criteria": "36a5345a-230d-438e-a04c-a287a513e3dc",
  "searchModel.query": "config from cloud.resource where api.name='aws-cloudtrail-describe-trails' AND cloud.type = 'aws' AND json.rule =  'isMultiRegionTrail is false'",
  "recommendation": "1. Login to AWS Console and navigate to the 'CloudTrail' service.\n2. If there are no CloudTrails in the account, create a new trail and select 'Yes' to 'Apply trail to all regions' setting.\n3. If the CloudTrail already exists for the account, make sure that under configuration > Trail Settings, 'Apply trail to all regions' is set to Yes.",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws cloudtrail update-trail --name ${resourceName} --region ${region} --include-global-service-events --is-multi-region-trail",
  "remediation.description": "This CLI command requires 'cloudtrail:UpdateTrail' permission. Successful execution will enable the CloudTrail in all regions.",
  "remediation.impact": "Enable CloudTrail in all regions",
  "compliance.standard": [
    "CCPA 2018",
    "CIS v1.2.0 (AWS)",
    "CIS v1.3.0 (AWS)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "MITRE ATT&CK [Beta]",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PCI DSS v3.2",
    "PIPEDA",
    "SOC 2"
  ]
}