{
  "policyUpi": "PC-AZR-ARM-501",
  "policyId": "40c06b29-589e-4f1f-8c02-8dafdc80cce6",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure subscriptions with custom roles are overly permissive",
  "description": "This policy identifies azure subscriptions with custom roles are overly permissive. Least privilege access rule should be followed and only necessary privileges should be assigned instead of allowing full administrative access",
  "rule.criteria": "aa1e6ee8-89aa-46eb-83a2-c2d8bd925117",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-role-definition' AND json.rule = properties.type equals \"CustomRole\" and properties.assignableScopes[*] contains \"/\" and properties.permissions[*].actions[*] starts with \"*\"",
  "recommendation": "Check the usage of the role identified.\nThrough console we cannot create, update or delete custom role.\nUse below CLI command to delete the role,\n'az role definition delete --name \\\"rolename\\\"'\nNote: Verify impact caused by deleting the role.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4"
  ]
}